<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:f="http://xmlns.jcp.org/jsf/core"
             xmlns:p="http://primefaces.org/ui"
             xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:composition template="/templates/template.xhtml">

        <ui:define name="bodycontent">

            <div class="bodyWrapper">
                <div class="ui-grid ui-grid-responsive formGrid">

                    <div class="titel">
                        Foto's Uploaden

                        <div class="onderTitel">
                            Kampioenschap: #{clubBeheerBean.kampioenschap.naam}
                        </div>
                    </div>


                    <h:form id="frm" enctype="multipart/form-data">

                        <div class="ui-grid-row formRow">
                            <div class="ui-grid-col-12">

                                <p:messages showDetail="true" closable="true"></p:messages>

                                <p:fileUpload fileUploadListener="#{fotoUploadBean.uploadFoto}"
                                              uploadLabel="Uploaden"
                                              cancelLabel="Annuleren"
                                              label="Bladeren"
                                              mode="advanced"
                                              sizeLimit="20971520"
                                              allowTypes="/\.(gif|jpg|jpeg|tiff|png|bmp)$/i"
                                              invalidFileMessage="Alleen .bmp, .gif, .jpeg, .jpg, .tiff en .png zijn toegelaten"
                                              invalidSizeMessage="Maximum toegelaten bestandsgrootte is 20 MB"
                                              multiple="true"
                                              id="file_foto"
                                              update=":frm:galleria :frm:lbl_galleria @all @form"
                                              oncomplete="fancyUp()"
                                              sequential="true"
                                        />

                            </div>
                        </div>

                        <div class="subTitel">
                            Preview
                        </div>

                        <p:outputLabel id="lbl_galleria" value="Voor dit kampioenschap zijn er nog geen foto's" rendered="#{fotoUploadBean.kampioenschap.fotos.size() == 0}" />

                        <p:galleria id="galleria" value="#{fotoUploadBean.kampioenschap.fotos}" var="foto" autoPlay="false" styleClass="centerPlus" rendered="#{fotoUploadBean.kampioenschap.fotos.size() > 0}" showCaption="true">
                            <a href="#{foto.fullPath}" class="fotoLink">
                                <p:graphicImage value="#{foto.fullPath}" alt="#{foto.caption}" title="#{foto.originalFilename}" styleClass="fancybox"></p:graphicImage>
                            </a>

                            <p:commandButton styleClass="btn_verwijderen"
                                             value="Verwijderen"
                                             actionListener="#{fotoUploadBean.verwijderFoto}"
                                             style="position:absolute; top:2px; right:0; z-index:10;"
                                             onclick="setId(this)"
                                             process="@form"
                                             update="@form :frm:galleria @all"
                                             oncomplete="fancyUp()"
                                    />

                            <p:commandButton value="Voeg tag toe"
                                             actionListener="#{fotoUploadBean.saveTag}"
                                             onclick="setId(this)"
                                             style="position: absolute; top:42px; right:0; z-index:10;"
                                             process="@form"
                                             update="@form"
                                             oncomplete="fancyUp()"
                                    />

                            <p:outputLabel style="display: none;" value="#{foto.id}" styleClass="lbl_id"/>
                        </p:galleria>

                        <div class="center top10">
                            <p:outputLabel value="Tag" styleClass="right10" rendered="#{fotoUploadBean.kampioenschap.fotos.size() > 0}"/>
                            <p:inputText value="#{fotoUploadBean.tag}" rendered="#{fotoUploadBean.kampioenschap.fotos.size() > 0}"></p:inputText>
                        </div>

                        <div class="pageButton">
                            <p:commandButton value="Terug" action="club_kampioenschapspagina?faces-redirect=true"></p:commandButton>
                        </div>

                        <h:inputHidden id="hdn_geselecteerdeFotoId" value="#{fotoUploadBean.geselecteerdeFotoId}" />

                    </h:form>

                </div>
            </div>

            <h:outputScript library="js" name="galleria.js" target="head"></h:outputScript>
            <h:outputScript library="js" name="jquery.fancybox.pack.js" target="head"></h:outputScript>
            <h:outputScript library="js" name="galleriaFancyBox.js" target="head"/>
            <h:outputStylesheet name="css/jquery.fancybox.css" />

        </ui:define>

    </ui:composition>

</ui:fragment>